<html>
    <head>
        <meta name='viewport'
            content='width=device-width, initial-scale=1'
        />
        <title>A.N.S.W.E.R.</title>
        <link rel='stylesheet'
            href='https://fonts.googleapis.com/css2?family=Material+Symbols+Sharp'
        />
        <link rel='stylesheet'
            href='https://unpkg.com/leaflet@1.9.4/dist/leaflet.css'
            integrity='sha256-p4NxAoJBhIIN+hmNHrzRCf9tD/miZyoHS5obTRR9BMY='
            crossorigin='http://localhost:3000'
        />
        <link rel='stylesheet' href='/index.css' />
        <script src='https://accounts.google.com/gsi/client' async></script>
        <script>
            function gsiDecode(token) {
                ; (token = token
                    .split('.')[1]
                    .replace(/-/g, '+') // :( -> :)
                    .replace(/_/g, '/'))
                token = atob(token) // base64 decode
                token = token.split('').map(character => {
                    const hexCode = character.charCodeAt(0).toString(16)
                    return `%${`00${hexCode}`.slice(-2)}`
                }).join('')
                token = decodeURIComponent(token)
                return JSON.parse(token)
            }
            function onSwig(response) {
                console.log(response)
                const payload = gsiDecode(response.credential)
                console.log(JSON.stringify(payload, undefined, 4))
            }
        </script>
        <!-- <script
            src='https://unpkg.com/leaflet@1.9.4/dist/leaflet.js'
            integrity='sha256-20nQCchB9co0qIjJZRGuk2/Z9VM+kNiyxNV1lvTlZBo='
            crossorigin='http://localhost:3000'
        ></script> -->
        <script type='module' src='/index.js'></script>
    </head>
    <body>
        <div id='not-modal'>
            <div class='menu'>
                <div class='title'>A.N.S.W.E.R.</div>
                <div class='subtitle'>
                    A Network of<br />
                    Survival, Welfare, and<br />
                    Essential Resources
                </div>
                <div class='cta'>
                    <button class='amber' id='search-button'>
                        <span class='material-symbols-sharp'>search</span>
                        Find food
                    </button>
                    <button class='blue' id='give-button'>Give food</button>
                    <button class='green' id='register-button'>Become an agent</button>
                    <button class='purple' id='login-button'>Login</button>
                </div>
            </div>
            <div class='map-container'>
                <div id='map'></div>
            </div>
        </div>
        <div id='modal-container'>
            <div id='give-modal' class='modal'>
                <div class='header'>
                    <div class='title'>Give Food</div>
                    <button id='give-modal-close'>Close</button>
                </div>
                <hr /><br />
                <label>
                    Location:
                    <input type='search' id='give-modal-input' />
                </label>
            </div>
            <div id='search-modal' class='modal'>
                <div class='header'>
                    <div class='title'>Find Food</div>
                    <button id='search-modal-close'>Close</button>
                </div>
                <hr /><br />
                <label>
                    Location:
                    <input type='search' id='search-input' />
                </label>
            </div>
            <div id='login-modal' class='modal'>
                <div class='header'>
                    <div class='title'>Login</div>
                    <button id='login-modal-close'>Close</button>
                </div>
                <hr /><br />
                <div class='g_id_signin'></div>
                <br />
                <form action='/api/sessions' method='POST'>
                    <label>
                        Email:
                        <input type='email' name='email' autocomplete='email' />
                    </label>
                    <br />
                    <label>
                        Password:
                        <input type='password' name='input' autocomplete='current-password' />
                    </label>
                    <br />
                    <input type='submit' value='Submit' />
                </form>
                <br />
                <button id='forgot-password'>Forgot password</button>
            </div>
            <div id='register-modal' class='modal'>
                <div class='header'>
                    <div class='title'>Become an Agent</div>
                    <button id='register-modal-close'>Close</button>
                </div>
                <hr /><br />
                <div class='g_id_signin'></div>
                <br />
                <form action='/api/registrations' method='POST'>
                    <label>
                        Email: <input type='email' name='email'
                            autocomplete='email'
                            id='register-email'
                        />
                    </label>
                    <br />
                    <label>
                        Password: <input type='password' name='input'
                            autocomplete='new-password'
                            id='register-input'
                        />
                    </label>
                    <br />
                    <label>
                        Confirm Password: <input type='password' name='input2'
                            autocomplete='new-password'
                            id='register-input2'
                        />
                    </label>
                    <br />
                    <input type='submit' value='Join' id='register-submit' />
                </form>
            </div>
            <div id='repass-modal' class='modal'>
                <div class='header'>
                    <div class='title'>Forgot Password</div>
                    <button id='repass-modal-close'>Close</button>
                </div>
                <hr /><br />
                <label>
                    Email:
                    <input type='email' autocomplete='email' id='repass-modal-input' />
                </label>
                <br /><br />
                <button id='repass-modal-submit'>Submit</button>
            </div>
        </div>
        <div id='g_id_onload'
            data-auto_prompt='false'
            data-login_uri='http://localhost:3000/api/sessions/swig'
            data-client_id='126168465185-0d0uhll9mjtu0cmqt9c5vnlm020bp5j6.apps.googleusercontent.com'
        ></div>
    </body>
</html>